
<!DOCTYPE html>
<html class='no-js' lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>Node-StudentsCoursesManagementSystem</title>
    <link href="/css/application-a07755f5.css" rel="stylesheet" type="text/css" />
    <link href="/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="/css/iconfont.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="/css/ui.jqgrid.css">
    <link href="/css/jquery-ui-1.8.16.custom.css" rel="stylesheet" type="text/css">
  </head>
    
  </head>
  <body class='main page'>
    <!-- Navbar -->
    <%- include('include/header') %> 
    <div id='wrapper'>
      <!-- Sidebar -->
      <%- include('include/sideBar') %>
      <!-- Tools -->
      <section id='tools'>
        <ul class='breadcrumb' id='breadcrumb'>
          <li class='active'>Students</li>
          <li><a href="/admin/student/import">Import Students</a></li>
        </ul>
      </section>
      <!-- Content -->
      <div id='content'>
        <div class='panel panel-default'>
          <div class='panel-heading'>
            All Students
          </div>
          <div class="panel-body">
            <!-- Use jqGrid to make a table -->
            <table id="list"></table> 
            <div id="listnav"></div>
            <input type="button" value="delete" id="delbtn">
          </div>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/bootstrap.js"></script>
    <script type="text/javascript" src="/js/jquery.jqGrid.src.js"></script>
    <script type="text/javascript" src="/js/grid.locale-cn.js"></script>
    <script>
        var lastsel;
        // initialize table
        function init(){
          $("#list").jqGrid( {
                datatype : "local",
                colNames : [ 'sid', 'name', 'grade', 'initial password'],
                colModel : [ 
                            {name : 'sid', index : 'sid',  width : 100 ,key:true}, 
                            {name : 'name',index : 'name', width : 100 , editable : true}, 
                            { name : 'grade', 
                              index : 'grade',  
                              width : 100 , 
                              editable : true,
                              edittype:"select",
                              editoptions : {value : "middle1:middle1; middle2:middle2; middle3:middle3; high1:high1; high2:high2; high3:high3 "}
                            },
                            {name : 'password', index : 'password',  width : 100 ,key:true}, 
                          ],
                rowNum : 2,
                rowList : [ 2, 4, 6 ],//how many rows u want to see in each page
                sortname : 'sid',
                pager : '#listnav',
                viewrecords: true,
                autowidth: true,
                height:400,
                cellEdit: true,
                cellsubmit:"clientArray",
                afterSaveCell: function(rowid,cellname,val,iRow,iCol) {
                    //alert(rowid);
                    //console.log(rowid,name,val,iRow,iCol)
                    var id =$("#list").getCell(iRow,0);
                    console.log(id,cellname,val)
                },
                onPaging:function(pgButton){
                  if(pgButton=="next_listnav"){
                       pageNum++;
                       getDataAndInitTable(pageNum);
                       $("#list").trigger("reloadGrid");
                  }
                }
                //multiselect : true,
                /*
                onSelectRow : function(id) {
                  //console.log("id:",id)
                    if (id && id !== lastsel) {
                      jQuery('#list').jqGrid('restoreRow', lastsel);
                      jQuery('#list').jqGrid('editRow', id, true);
                      lastsel = id;
                    }
                  },
                pager : 'listnav'*/
          })
        } 
              /*
              $("#list").jqGrid('navGrid', "#listnav", {
                edit : false,
                add : false,
                del : false
              });
              $("#list").jqGrid('inlineNav', "#listnav");*/

              /*
              $("#delbtn").click(function() {
                var gr = $("#list").jqGrid('getGridParam', 'selrow');
                alert(gr)
              });*/


            /*
            var data=[
                  { "sid":"John", "name":30, "age":15 },
                  { "sid":"John", "name":30, "age":15 },
                  { "sid":"John", "name":30, "age":15 },
                  { "sid":"John", "name":30, "age":15 }
            ]
            for ( var i = 0; i <= data.length; i++){
                  $("#list").jqGrid('addRowData', i + 1, data[i]);
            }*/

            //request data, then insert rows
            /*
            getDataAndInitTable(1);
            function getDataAndInitTable(pageNum){
              console.log("pageNum:",pageNum)
              $.get("/data"+pageNum+".txt",function(data){
                  init();
                  //console.log("data",data)
                  //var data=JSON.parse(data).result;
                  //console.log("data2",data)
                  var data=JSON.parse(data);
                  for ( var i = 0; i <= data.length; i++){
                    $("#list").jqGrid('addRowData', i + 1, data[i]);
                  }
  
                  //jQuery("#list").jqGrid('navGrid', '#listnav', {edit : false,add : false,del : false});
              })
            }*/

            $.get("/student",function(data){
                  init();
                  //console.log("data",data)
                  //var data=JSON.parse(data).result;
                  //console.log("data2",data)
                  var data=data.results;
                  for ( var i = 0; i <= data.length; i++){
                    $("#list").jqGrid('addRowData', i + 1, data[i]);
                  }
            })

    </script>
  </body>
</html>
